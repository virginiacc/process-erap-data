{"version":3,"sources":["CSVReader.js","App.js","utils.js","index.js"],"names":["CSVReaderComponent","handleOnDrop","data","props","handler","handleOnError","err","file","inputElem","reason","console","log","handleOnRemoveFile","removeHeaders","chunk","rows","split","splice","join","onDrop","this","onError","addRemoveButton","onRemoveFile","config","header","beforeFirstChunk","accept","Component","App","useState","programs","setPrograms","noContact","setNoContact","noURL","setNoURL","noCounty","setNoCounty","allData","setAllData","className","importedJSON","map","item","generateJSON","results","forEach","itemCopy","type","val","state","county","counties","push","contact","program","startsWith","getContactInfo","processPrograms","length","index","name","url","onClick","navigator","clipboard","writeText","JSON","stringify","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5fcb8cec.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nimport { CSVReader } from 'react-papaparse'\n\nexport default class CSVReaderComponent extends Component {\n  handleOnDrop = (data) => {\n    this.props.handler(data);\n  }\n\n  handleOnError = (err, file, inputElem, reason) => {\n    console.log(err)\n  }\n\n  handleOnRemoveFile = (data) => {\n    this.props.handler([])\n  }\n\n  removeHeaders = (chunk) => {\n    var rows = chunk.split( /\\r\\n|\\r|\\n/ );\n    rows.splice(0, 3);\n    return rows.join(\"\\r\\n\");\n  }\n\n  render() {\n    return (\n      <CSVReader\n        onDrop={this.handleOnDrop}\n        onError={this.handleOnError}\n        addRemoveButton\n        onRemoveFile={this.handleOnRemoveFile}\n        config={{header:true, beforeFirstChunk: this.removeHeaders}}\n        accept='text/csv, .csv, .tsv, application/vnd.ms-excel'>\n        <span>Drop CSV file here or click to upload.</span>\n      </CSVReader>\n    )\n  }\n}","import './App.css';\nimport { useState } from 'react';\nimport CSVReaderComponent from './CSVReader.js';\nimport { diff, generateJSON, processPrograms } from './utils.js';\n// import prev from './latest.json';\n\n\n// Processing involves:\n// - removing first three rows of headers from tsv\n// - converting tsv to json\n// - mapping to new json objects, copying only needed values:\n//     - \"Geographic Level\" => \"Type\"\n// .   - \"State\" or \"Tribal Government/ Territory\" => \"State\"\n//       - Mariana Islands renamed to match state value in state select\n//     - \"Program Name\" => \"Program\"\n//     - \"City/County/ Locality\" or \n//       \"Tribal Government/ Territory\" or\n//       \"State\" => \"Name\"\n//     - Add \"County\" using county map if City\n//     - \"Program Page Link  (Phone # if Link is Unavailable)\" =>\n//       \"URL\" or \"Phone\" depending on value\n\n\n\nfunction App() {\n  const [ programs, setPrograms ] = useState( [] );\n  const [ noContact, setNoContact ]= useState( [] );\n  const [ noURL, setNoURL ]= useState( [] );\n  const [ noCounty, setNoCounty ]= useState( [] );\n  const [ allData, setAllData ]= useState( [] );\n  // const [ changed, setChanged ] = useState( [] );\n\n  const csvToJSON = data => {\n    let importedJSON = generateJSON( data );\n    const results = processPrograms( importedJSON );\n    setPrograms( results.programs )\n    setNoContact( results.noContact );\n    setNoURL( results.noURL );\n    setNoCounty( results.noCounty );\n    setAllData(importedJSON)\n    // let updates = diff(prev, importedJSON)\n    // setChanged(updates.changed)\n  }\n\n  const copy = () => {\n    navigator.clipboard.writeText( JSON.stringify(programs) )\n  }\n\n  const copyFull = () => {\n    navigator.clipboard.writeText( JSON.stringify(allData) )\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"reader block u-mt15\">\n        <CSVReaderComponent handler={ csvToJSON }/>\n      </div>\n      { programs.length > 0 &&\n      <div>\n        <h1>Programs</h1>\n        { ( noContact.length > 0 || noURL.length > 0 || noCounty.length > 0 ) &&\n          <h2>Issues</h2>\n        }\n        { noContact.length > 0 &&\n          <div className=\"block block__sub\">\n            <h3>No contact info</h3>\n            <ul>\n            { noContact.map( ( item, index ) => (\n              <li key={index}>{item}</li>\n            ) ) } \n            </ul>\n          </div>\n        }\n        { noURL.length > 0 &&\n          <div className=\"block block__sub\">\n            <h3>No URL</h3>\n            <ul>\n            { noURL.map( ( item, index ) => (\n              <li key={index}>{item[0]}: {item[1]}</li>\n            ) ) } \n            </ul>\n          </div>\n        }\n        { noCounty.length > 0 &&\n          <div className=\"block block__sub\">\n            <h3>Cities not in county list</h3>\n            <ul>\n            { noCounty.map( ( item, index ) => (\n              <li  key={index}>{item}</li>\n            ) ) } \n            </ul>\n          </div>\n        }\n{/*         <h2>Changed: {changed.length}</h2> */}\n{/*         <ul> */}\n{/*         {changed.map(( item, index) => ( */}\n{/*           <li>  - { item[0] } </li> */}\n{/*         ))} */}\n{/* </ul> */}\n{/*         {changed.map(( item, index) => ( */}\n{/*             <div className=\"block block__sub\" key={index}> */}\n{/*                 <table className=\"changedTable\"> */}\n{/*                     <thead> */}\n{/*                       <tr> */}\n{/*                         <th>{item[0]}</th> */}\n{/*                         <th>Before</th> */}\n{/*                         <th>After</th> */}\n{/*                       </tr> */}\n{/*                     </thead> */}\n{/*                     <tbody> */}\n{/*                       {item[1].map(( prop, i ) => ( */}\n{/*                          */}\n{/*                             <tr> */}\n{/*                               <td> */}\n{/*                                 {prop[0]} */}\n{/*                               </td> */}\n{/*                               <td> */}\n{/*                                 <span>{prop[1]}</span> */}\n{/*                               </td> */}\n{/*                               <td> */}\n{/*                                 <span>{prop[2]}</span> */}\n{/*                               </td> */}\n{/*                             </tr> */}\n{/*                          */}\n{/*                          */}\n{/*                       ))} */}\n{/*                   </tbody> */}\n{/*                   </table> */}\n{/*             </div> */}\n{/*         ))} */}\n        \n        <div className=\"block\">\n          <h2> There are {programs.length} programs</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>State</th>\n                <th>Type</th>\n                <th>Name</th>\n                <th>Program</th>\n                <th>URL</th>\n                <th>Phone</th>\n                <th>County</th>\n              </tr>\n            </thead>\n            <tbody>\n          { programs.map( ( item, index ) => (\n              <tr key={index}>\n                <td>{ item.state }</td>\n                <td>{ item.type }</td>\n                <td>{ item.name }</td>\n                <td>{ item.program }</td>\n                <td className=\"url\">{ item.url }</td>\n                <td>{ item[\"Phone\"] }</td>\n                <td>\n                  <ul>\n                    { item.county && item.county.map( ( county, index ) => (\n                      <li  key={ index }>{ county }</li>\n                    ) ) } \n                    </ul>\n                </td>\n              </tr>\n            ) ) } \n          </tbody>\n          </table>\n        </div>\n        <h2>JSON</h2>\n        <button className=\"a-btn u-mb15\" onClick={ copy }>Copy JSON</button>\n        <div className=\"json\">\n          { JSON.stringify(programs) }\n        </div>\n        <button className=\"a-btn u-mb15\" onClick={ copyFull }>Copy ALL JSON</button>\n\n\n      </div>\n      }\n    </div>\n  );\n}\n\nexport default App;\n","import counties from './county-map.json';\n\nexport const generateJSON = data => {\n  return data.map( item => {\n    return item['data']\n  })\n}\n\nexport const getContactInfo = ( val, program ) => {\n  if ( val ) {\n    if ( val.startsWith( 'http' ) ){\n      return ['url', val];\n    } else if ( val.startsWith( 'www' ) ) {\n      return ['url', 'http://' + val ];\n    } else {\n      return ['phone', val];\n    }\n  }\n}\n\nexport const processPrograms = programs => {\n  let results = [];\n  let noContact = [];\n  let noURL = [];\n  let noCounty = [];\n  programs.forEach( item => {\n    let itemCopy = {};\n    // Copy and rename values\n    // Copy Geographic Level as Type\n    let type = item['Geographic Level'];\n    itemCopy['type'] = type;\n    // Copy State as State\n    itemCopy['state'] = item['State'];\n    // Set State to territory name if territory\n    if ( type === 'Territory' ) {\n      let val = item['Tribal Government/ Territory'];\n      if ( val === 'Commonwealth of the Northern Mariana Islands' ) {\n        // Rename Mariana Islands to match state name\n        itemCopy['state'] = 'Northern Mariana Islands';\n      } else {\n        itemCopy['state'] = val;\n      }\n    }\n    // copy Program Name as Program\n    itemCopy['program'] = item['Program Name'];\n    // Set Name based on type\n    itemCopy['name'] = item['City/County/ Locality'] ||\n                       item['Tribal Government/ Territory'] ||\n                       item['State'];\n    // Add County if type === 'City'\n    if ( type === 'City' ) {\n      const state = item['State'];\n      let stateObj = counties[state] || {};\n      let county = stateObj[item['City/County/ Locality']]\n      itemCopy['county'] = county;\n      if (!county) {\n        noCounty.push( `${item['City/County/ Locality']}, ${item['State']}`)\n      }\n    }\n    // check to see whether contact info is URL or phone\n    // and set Phone or URL property\n    let contact = getContactInfo(\n      item['Program Page Link  (Phone # if Link is Unavailable)']\n    )\n    if (contact) {\n      itemCopy[contact[0]] = contact[1];\n      if ( contact[0] === 'phone' ) {\n        noURL.push( [item['Program Name'], contact[1]] )\n      }\n    } else {\n      noContact.push(item['Program Name']);\n    }\n    results.push(itemCopy)\n  })\n  return {\n    programs: results,\n    noContact: noContact,\n    noCounty: noCounty,\n    noURL: noURL\n  }\n}\n\nexport const diff = ( prev, current ) => {\n  let changedRecords = [];\n  let addedRecords = [];\n  let removedRecords = [];\n  let foundRecords = [];\n  current.forEach( item => {\n    let match = false;\n    let changed = [];\n    prev.some( prevItem => {\n      if ( item['Program Name'] === prevItem['Program Name']  && item['State'] === prevItem['State']) {\n        match = true;\n        Object.keys( item ).forEach( key => {\n          if ( item[key] !== prevItem[key] ) {\n            changed.push([key, prevItem[key], item[key]])\n          }\n        })\n        return match\n      }\n      return false;\n    })\n    if ( match ) {\n      foundRecords.push( item['Program Name'] );\n      if ( Object.keys(changed).length ) {\n        changedRecords.push([item['City/County/ Locality'] + ', ' + item['State'] + ': ' + changed[0][2], changed])\n      }\n    } else {\n      addedRecords.push(item)\n    }\n  })\n  console.log(foundRecords)\n  prev.forEach( item => {\n    if ( !foundRecords.includes(item['Program Name'] )) {\n      removedRecords.push(item)\n    }\n  })\n\n  return {\n    added: addedRecords, \n    removed: removedRecords,\n    changed: changedRecords\n  }\n}\n\n\n\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}